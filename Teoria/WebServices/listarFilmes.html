<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Filmes Cadastrados</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- cabeçalho da página com o título e um botão para voltar ao cadastro -->
    <header class="header-listar">
        <h1>Filmes Cadastrados</h1>
        <a href="/cadastro" class="btn-cadastrar">Cadastrar Novo Filme</a>
    </header>
    <main>
        <!-- container que vai abrigar todos os cards de filmes que serão gerados pelo script -->
        <div id="filmes-container" class="filmes-container"></div>
    </main>

    <script>
        // evento que será disparado quando a página terminar de carregar
        document.addEventListener('DOMContentLoaded', function() {
            //requisição para o endpoint /get_filmes
            fetch('/get_filmes')
                // Quando a resposta chegar, passa ela para o formato JSON
                .then(response => response.json()) 
                // chamo a função para criar os cards
                .then(data => {
                    // elemento container onde os cards serão inseridos
                    const filmesContainer = document.getElementById('filmes-container');
                    
                    // Percorro cada filme retornado pela API
                    for (const id in data) {
                        const filme = data[id];
                        
                        // novo elemento 'div' para o card
                        const card = document.createElement('div');
                        card.classList.add('movie-card'); // classe de estilo ao card
                        
                        // conteúdo HTML do card, preenchendo com os dados do filme
                        card.innerHTML = `
                            <h2>${filme.nome} (${filme.ano})</h2>
                            <p><strong>Gênero:</strong> ${filme.genero}</p>
                            <p><strong>Diretor:</strong> ${filme.diretor}</p>
                            <p><strong>Atores:</strong> ${filme.atores}</p>
                            <p><strong>Produtora:</strong> ${filme.produtora}</p>
                            <div class="sinopse">
                                <strong>Sinopse:</strong>
                                <p>${filme.sinopse}</p>
                            </div>
                        `;
                        
                        // adiciona o card recém-criado dentro do container
                        filmesContainer.appendChild(card);
                    }
                })
                // Se der algum erro na requisição, exibe no console do navegador
                .catch(error => console.error('Erro ao buscar filmes:', error));
        });
    </script>
</body>
</html>